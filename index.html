<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>عرض تلقائي لصورة واحدة في كل مرة</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      background: #000;
      color: #fff;
      height: 100vh;
      overflow: hidden; /* لا نريد سكرول */
      display: flex;
      flex-direction: column;
    }

    header {
      text-align: center;
      padding: 8px 10px;
      background: #111;
      font-size: 16px;
    }

    main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;
      position: relative;
    }

    #imagePlayer,
    #videoPlayer {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain; /* يناسب شاشات 94 إنش والموبايل */
      display: none;       /* نظهر واحد فقط */
    }

    #counter {
      position: absolute;
      bottom: 12px;
      left: 12px;
      background: rgba(0,0,0,0.6);
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 13px;
    }

    #titleBar {
      font-size: 14px;
      opacity: 0.8;
    }
  </style>
</head>
<body>

  <header>
    <div id="titleBar">عرض تلقائي – صورة واحدة / فيديو واحد في كل مرة</div>
  </header>

  <main>
    <img id="imagePlayer" src="" alt="" />
    <video id="videoPlayer" src="" controls></video>
    <div id="counter"></div>
  </main>

  <script>
    const IMAGES_BASE = "images/";   // اسم مجلد الصور كما طلبت
    const IMAGE_DURATION = 5000;     // مدة عرض كل صورة بالملّي ثانية (هنا 5 ثوانٍ)
    const VIDEO_EXTENSIONS = [".mp4", ".webm", ".ogg"];

    const imgEl = document.getElementById("imagePlayer");
    const videoEl = document.getElementById("videoPlayer");
    const counterEl = document.getElementById("counter");
    const titleBar = document.getElementById("titleBar");

    let playlist = [];
    let currentIndex = 0;
    let imageTimer = null;

    function isVideoFile(name) {
      const lower = name.toLowerCase();
      return VIDEO_EXTENSIONS.some(ext => lower.endsWith(ext));
    }

    function clearTimers() {
      if (imageTimer) {
        clearTimeout(imageTimer);
        imageTimer = null;
      }
      videoEl.pause();
      videoEl.currentTime = 0;
    }

    function showItem(index) {
      if (!playlist.length) return;

      clearTimers();

      currentIndex = (index + playlist.length) % playlist.length;
      const fileName = playlist[currentIndex];
      const fileUrl = IMAGES_BASE + fileName;
      const total = playlist.length;

      counterEl.textContent = `عنصر ${currentIndex + 1} من ${total}`;
      titleBar.textContent = fileName;

      const isVideo = isVideoFile(fileName);

      if (isVideo) {
        // عرض فيديو واحد
        imgEl.style.display = "none";
        videoEl.style.display = "block";
        videoEl.src = fileUrl;

        // قد يمنع المتصفح التشغيل التلقائي بالصوت، يمكنك إضافة videoEl.muted = true;
        videoEl.play().catch(() => {
          // لو المتصفح منع التشغيل التلقائي، يبقى الفيديو جاهز حتى يضغط المستخدم
        });

        // عندما ينتهي الفيديو ننتقل تلقائيًا للذي بعده
        videoEl.onended = () => {
          showItem(currentIndex + 1);
        };
      } else {
        // عرض صورة واحدة
        videoEl.style.display = "none";
        imgEl.style.display = "block";
        imgEl.src = fileUrl;

        // بعد مدة ثابتة ننتقل للصورة التالية
        imageTimer = setTimeout(() => {
          showItem(currentIndex + 1);
        }, IMAGE_DURATION);
      }
    }

    // تحميل قائمة الملفات من images.json
    fetch("images.json")
      .then(res => {
        if (!res.ok) throw new Error("تعذر تحميل images.json");
        return res.json();
      })
      .then(data => {
        playlist = Array.isArray(data.images) ? data.images : [];
        if (!playlist.length) {
          titleBar.textContent = "لا توجد عناصر في images.json";
          return;
        }
        showItem(0);
      })
      .catch(err => {
        console.error(err);
        titleBar.textContent = "حدث خطأ في قراءة images.json – تأكد من مكان الملف.";
      });

    // إذا أردت إمكانية الانتقال بالكيبورد:
    window.addEventListener("keydown", (e) => {
      if (!playlist.length) return;
      if (e.key === "ArrowRight") {
        showItem(currentIndex + 1);
      } else if (e.key === "ArrowLeft") {
        showItem(currentIndex - 1);
      }
    });
  </script>
</body>
</html>
