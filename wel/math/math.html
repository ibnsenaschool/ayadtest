<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…Ø­Ø·Ø§Øª Ù…Ù† Ø­ÙŠØ§ØªÙ†Ø§ â€“ Ù†Ø³Ø®Ø© Ù…Ø¨Ø³Ø·Ø©</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      overflow-x: hidden;
    }

    .container {
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,.3);
      padding: 30px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .header { text-align: center; margin-bottom: 30px; }
    h1 {
      color: #333;
      font-size: 36px;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .subtitle { color: #666; font-size: 16px; font-style: italic; }

    .loading { text-align: center; padding: 80px 20px; color: #667eea; }
    .loading-spinner {
      border: 5px solid #f3f3f3; border-top: 5px solid #667eea; border-radius: 50%;
      width: 60px; height: 60px; animation: spin 1s linear infinite; margin: 0 auto 20px;
    }
    @keyframes spin { 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }

    /* ===== Viewer ===== */
    .viewer-wrapper {
      position: relative; background: #000; border-radius: 15px; overflow: hidden;
      margin-bottom: 25px; box-shadow: 0 10px 30px rgba(0,0,0,.3);
    }
    .viewer-section {
      min-height: 500px; display: flex; align-items: center; justify-content: center; position: relative; background: #000;
    }
    .media-display { width: 100%; max-height: 600px; object-fit: contain; display: block; }

    /* Ù„Ø§ Ù†Ø¸Ù‡Ø± Ø§Ø³Ù… Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ Ù…ÙŠØªØ§Ø¯Ø§ØªØ§ */
    .media-info { display: none; }

    .placeholder { color: #666; text-align: center; padding: 100px 20px; }
    .placeholder-icon { font-size: 100px; margin-bottom: 20px; opacity: .3; }

    .controls { background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
    .control-row { display: flex; gap: 15px; justify-content: center; align-items: center; flex-wrap: wrap; margin-bottom: 15px; }
    .control-row:last-child { margin-bottom: 0; }

    .nav-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff; border: none; padding: 14px 35px; border-radius: 10px; font-size: 16px; font-weight: bold;
      cursor: pointer; transition: all .3s ease; box-shadow: 0 4px 10px rgba(102,126,234,.3); min-width: 140px;
    }
    .nav-btn:hover:not(:disabled){ transform: translateY(-3px); box-shadow: 0 6px 15px rgba(102,126,234,.5); }
    .nav-btn:disabled { opacity: .4; cursor: not-allowed; transform: none; }

    .play-btn { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); font-size: 18px; min-width: 160px; padding: 16px 40px; }
    .play-btn:hover:not(:disabled){ box-shadow: 0 6px 15px rgba(40,167,69,.5); }
    .play-btn.playing { background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); }

    .fullscreen-btn { background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); min-width: 120px; }
    .fullscreen-btn:hover { box-shadow: 0 6px 15px rgba(220,53,69,.5); }

    .speed-control { display: flex; align-items: center; gap: 15px; background: #fff; padding: 12px 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,.1); }
    .speed-label { color: #333; font-weight: bold; font-size: 14px; white-space: nowrap; }
    .speed-slider { width: 180px; height: 6px; border-radius: 5px; background: #e0e0e0; outline: none; cursor: pointer; -webkit-appearance: none; }
    .speed-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,.3); }
    .speed-slider::-moz-range-thumb { width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,.3); border: none; }
    .speed-value { color: #667eea; font-weight: bold; font-size: 14px; min-width: 45px; text-align: center; }

    .error-box { background: #ffebee; color: #c62828; padding: 20px; border-radius: 12px; text-align: center; margin: 20px 0; border-right: 5px solid #c62828; }
    .error-box h3 { margin-bottom: 10px; font-size: 20px; }
    .error-box p { line-height: 1.6; font-size: 14px; }

    /* ===== Fullscreen fix: ØºØ·Ø§Ø¡ ÙƒØ§Ù…Ù„ Ù„Ù„Ø´Ø§Ø´Ø© ===== */
    .viewer-wrapper:fullscreen,
    .viewer-wrapper:-webkit-full-screen,
    .viewer-wrapper:-moz-full-screen { background: #000; }

    .viewer-wrapper:fullscreen .viewer-section,
    .viewer-wrapper:-webkit-full-screen .viewer-section,
    .viewer-wrapper:-moz-full-screen .viewer-section { min-height: 100vh; }

    .viewer-wrapper:fullscreen .media-display,
    .viewer-wrapper:-webkit-full-screen .media-display,
    .viewer-wrapper:-moz-full-screen .media-display {
      width: 100vw; height: 100vh; object-fit: cover; /* ÙŠØºØ·ÙŠ Ø§Ù„Ø´Ø§Ø´Ø© ÙƒØ§Ù…Ù„Ø© */
    }

    @media (max-width: 768px) {
      .container { padding: 20px; }
      h1 { font-size: 26px; }
      .control-row { flex-direction: column; }
      .nav-btn, .play-btn, .fullscreen-btn { width: 100%; min-width: auto; }
      .speed-control { flex-direction: column; width: 100%; }
      .speed-slider { width: 100%; }
      .viewer-section { min-height: 300px; }
      .media-display { max-height: 400px; }
    }
    @media (max-width: 480px) {
      h1 { font-size: 22px; }
      .subtitle { font-size: 14px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>âœ¨ Ù…Ø­Ø·Ø§Øª Ù…Ù† Ø­ÙŠØ§ØªÙ†Ø§</h1>
      <p class="subtitle">Ø°ÙƒØ±ÙŠØ§Øª Ø¬Ù…ÙŠÙ„Ø© ØªÙØ±ÙˆÙ‰ Ø¨Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ</p>
    </div>

    <div id="loadingArea" class="loading">
      <div class="loading-spinner"></div>
      <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª...</p>
    </div>

    <div id="mainContent" style="display: none;">
      <!-- ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒÙ„ÙŠÙ‹Ø§ -->

      <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ -->
      <div class="viewer-wrapper" id="viewerWrapper">
        <div class="viewer-section" id="viewerSection">
          <div class="placeholder">
            <div class="placeholder-icon">ğŸ“¸</div>
            <h3>Ø§Ø³ØªØ¹Ø¯ Ù„Ø±Ø­Ù„Ø© Ø¹Ø¨Ø± Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª</h3>
            <p>Ø§Ø¶ØºØ· "ØªØ´ØºÙŠÙ„" Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø±Ø¶</p>
          </div>
        </div>
      </div>

      <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… -->
      <div class="controls">
        <div class="control-row">
          <button class="nav-btn" id="prevBtn" onclick="navigateMedia(-1)">â®ï¸ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
          <button class="play-btn" id="playBtn" onclick="toggleAutoPlay()">â–¶ï¸ ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
          <button class="nav-btn" id="nextBtn" onclick="navigateMedia(1)">Ø§Ù„ØªØ§Ù„ÙŠ â­ï¸</button>
        </div>
        <div class="control-row">
          <div class="speed-control">
            <span class="speed-label">â±ï¸ Ø³Ø±Ø¹Ø© Ø§Ù„Ø¹Ø±Ø¶:</span>
            <input type="range" id="speedSlider" class="speed-slider" min="1" max="10" value="3" step="1" oninput="updateSpeed(this.value)" />
            <span class="speed-value" id="speedValue">3 Ø«</span>
          </div>
          <button class="fullscreen-btn" onclick="toggleFullscreen()">ğŸ–¥ï¸ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©</button>
        </div>
      </div>
    </div>

    <div id="errorArea"></div>
  </div>

  <script>
    // ===== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© =====
    let allFiles = [];
    let currentIndex = -1;
    let isPlaying = false;
    let playSpeed = 3000; // ms

    const videoExts = ['.mp4', '.webm', '.ogg', '.mov', '.avi', '.mkv', '.flv', '.wmv', '.m4v', '.3gp'];
    const imageExts = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.svg', '.bmp', '.ico'];

    function getFileType(filename){
      const ext = filename.substring(filename.lastIndexOf('.')).toLowerCase();
      if (videoExts.includes(ext)) return 'video';
      if (imageExts.includes(ext)) return 'image';
      return null;
    }

    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ù…Ù† Ø±Ø§Ø¨Ø· GitHub Pages
    function getRepoInfo(){
      const url = window.location.href;
      const match = url.match(/https?:\/\/([^.]+)\.github\.io\/([^\/]+)(?:\/(.*))?/);
      if (match){
        const owner = match[1];
        const repo = match[2];
        const fullPath = match[3] || '';
        const pathParts = fullPath.split('/');
        pathParts.pop(); // Ø¥Ø²Ø§Ù„Ø© Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„Ù€ HTML
        const path = pathParts.join('/');
        return { owner, repo, path };
      }
      return null;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ù† Ù…Ø¬Ù„Ø¯ Ø§Ù„ØµÙØ­Ø© Ø¹Ù„Ù‰ GitHub
    async function loadFiles(){
      try{
        const repoInfo = getRepoInfo();
        if (!repoInfo){
          showError('Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ø¯ÙŠØ¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹', 'ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØµÙØ­Ø© Ù…Ø±ÙÙˆØ¹Ø© Ø¹Ù„Ù‰ GitHub Pages Ø¨Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ­.<br>Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ†: <code>username.github.io/repo-name/</code>');
          return;
        }
        const { owner, repo, path } = repoInfo;
        const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
        const response = await fetch(apiUrl);
        if (!response.ok) throw new Error(`Ø®Ø·Ø£ Ù…Ù† GitHub API: ${response.status}`);
        const files = await response.json();

        allFiles = files
          .filter(f => f.type === 'file')
          .map(f => ({ name: f.name, url: f.download_url, type: getFileType(f.name), size: f.size }))
          .filter(f => f.type !== null);

        if (allFiles.length === 0){
          showError('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª ÙˆØ³Ø§Ø¦Ø·', 'ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„ÙØ§Øª ØµÙˆØ± Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ ÙÙŠ Ù†ÙØ³ Ù…Ø¬Ù„Ø¯ Ø§Ù„ØµÙØ­Ø©.');
          return;
        }
        displayContent();
      }catch(err){
        console.error(err);
        showError('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª', `Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ GitHub: ${err.message}<br><br>ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø¹Ø§Ù… ÙˆØ§Ù„ØµÙØ­Ø© Ù…Ø±ÙÙˆØ¹Ø© Ø¹Ù„Ù‰ GitHub Pages.`);
      }
    }

    function displayContent(){
      document.getElementById('loadingArea').style.display = 'none';
      document.getElementById('mainContent').style.display = 'block';
      if (allFiles.length > 0) playMedia(0);
    }

    function playMedia(index){
      if (index < 0 || index >= allFiles.length) return;
      currentIndex = index;
      const file = allFiles[index];
      const viewer = document.getElementById('viewerSection');

      let mediaHtml = '';
      if (file.type === 'video'){
        mediaHtml = `
          <video class="media-display" controls autoplay onended="onMediaEnded()">
            <source src="${file.url}">
            Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
          </video>`;
      } else {
        mediaHtml = `<img src="${file.url}" class="media-display" alt="" onload="onMediaLoaded()">`;
      }

      // ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙƒÙŠ Ù„Ø§ ÙŠØ¸Ù‡Ø± Ø§Ø³Ù… Ø§Ù„ØµÙˆØ±Ø©
      viewer.innerHTML = mediaHtml;

      // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ (Ø§Ù„ØªÙØ§Ù Ø¯Ø§Ø¦Ø±ÙŠ Ù…ØªØ§Ø­ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø£ÙŠØ¶Ù‹Ø§)
      document.getElementById('prevBtn').disabled = false;
      document.getElementById('nextBtn').disabled = false;
    }

    function onMediaLoaded(){
      if (isPlaying && allFiles[currentIndex].type === 'image'){
        setTimeout(() => { if (isPlaying) navigateMedia(1); }, playSpeed);
      }
    }

    function onMediaEnded(){ if (isPlaying) navigateMedia(1); }

    function navigateMedia(direction){
      let newIndex = currentIndex + direction;
      if (newIndex >= allFiles.length) newIndex = 0; // Ø§Ù„ØªÙØ§Ù Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
      else if (newIndex < 0) newIndex = allFiles.length - 1; // Ø§Ù„ØªÙØ§Ù Ù„Ù„Ù†Ù‡Ø§ÙŠØ©
      playMedia(newIndex);
    }

    function toggleAutoPlay(){
      isPlaying = !isPlaying;
      const btn = document.getElementById('playBtn');
      if (isPlaying){
        btn.textContent = 'â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù';
        btn.classList.add('playing');
        if (allFiles[currentIndex]?.type === 'image') onMediaLoaded();
      } else {
        btn.textContent = 'â–¶ï¸ ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ';
        btn.classList.remove('playing');
      }
    }

    function updateSpeed(value){
      playSpeed = value * 1000; // sec -> ms
      document.getElementById('speedValue').textContent = value + ' Ø«';
    }

    function toggleFullscreen(){
      const wrapper = document.getElementById('viewerWrapper');
      if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement){
        if (wrapper.requestFullscreen) wrapper.requestFullscreen();
        else if (wrapper.webkitRequestFullscreen) wrapper.webkitRequestFullscreen();
        else if (wrapper.mozRequestFullScreen) wrapper.mozRequestFullScreen();
      } else {
        if (document.exitFullscreen) document.exitFullscreen();
        else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        else if (document.mozCancelFullScreen) document.mozCancelFullScreen();
      }
    }

    // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
    document.addEventListener('keydown', (e) => {
      if (allFiles.length === 0) return;
      switch(e.key){
        case 'ArrowRight':
        case 'ArrowUp':
          navigateMedia(-1); // Ø§Ù„Ø³Ø§Ø¨Ù‚
          break;
        case 'ArrowLeft':
        case 'ArrowDown':
          navigateMedia(1); // Ø§Ù„ØªØ§Ù„ÙŠ
          break;
        case ' ': // Ù…Ø³Ø§ÙØ©
          e.preventDefault();
          toggleAutoPlay();
          break;
        case 'f':
        case 'F':
          toggleFullscreen();
          break;
      }
    });

    function showError(title, message){
      document.getElementById('loadingArea').style.display = 'none';
      document.getElementById('errorArea').innerHTML = `
        <div class="error-box">
          <h3>âŒ ${title}</h3>
          <p>${message}</p>
        </div>`;
    }

    window.addEventListener('load', loadFiles);
  </script>
</body>
</html>
