<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙˆÙ† - Ù…Ø¯Ø±Ø³Ø© Ø§Ø¨Ù† Ø³ÙŠÙ†Ø§ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.2em;
        }

        /* Navigation */
        .nav-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .grade-group {
            margin-bottom: 20px;
        }

        .grade-group:last-child {
            margin-bottom: 0;
        }

        .grade-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            padding-right: 10px;
        }

        .class-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .class-btn {
            padding: 12px 25px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s;
            color: #333;
        }

        .class-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .class-btn.active {
            background: #667eea;
            color: white;
            border-color: #764ba2;
        }

        .auto-play-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            padding-top: 15px;
            border-top: 2px solid #eee;
        }

        .control-btn {
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .control-btn:hover {
            background: #218838;
            transform: scale(1.05);
        }

        .control-btn.stop {
            background: #dc3545;
        }

        .control-btn.stop:hover {
            background: #c82333;
        }

        /* Class Display */
        .class-display {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 400px;
        }

        .class-title {
            text-align: center;
            font-size: 2.2em;
            color: #667eea;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .student-card {
            max-width: 600px;
            margin: 0 auto;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .student-photo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            margin: 0 auto 25px;
            border: 6px solid white;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6em;
            color: #999;
            overflow: hidden;
        }

        .student-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .student-name {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
        }

        .average-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 25px;
        }

        .average-label {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 10px;
        }

        .average-value {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
        }

        .star-badge {
            display: inline-block;
            background: gold;
            color: #333;
            padding: 10px 25px;
            border-radius: 25px;
            margin-top: 20px;
            font-weight: bold;
            font-size: 1.3em;
        }

        .subjects-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .subject-item {
            background: rgba(255,255,255,0.5);
            padding: 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .subject-icon {
            font-size: 1.5em;
        }

        .subject-name {
            font-weight: bold;
            color: #333;
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .header p {
                font-size: 1em;
            }

            .class-btn {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            .class-display {
                padding: 20px;
            }

            .class-title {
                font-size: 1.5em;
            }

            .student-card {
                padding: 25px;
            }

            .student-photo {
                width: 150px;
                height: 150px;
                font-size: 4em;
            }

            .student-name {
                font-size: 1.5em;
            }

            .average-value {
                font-size: 2.5em;
            }

            .subjects-list {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 50px;
            color: #667eea;
            font-size: 1.5em;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        .no-data {
            text-align: center;
            padding: 50px;
            color: #999;
            font-size: 1.3em;
        }

        .error-message {
            text-align: center;
            padding: 30px;
            color: #dc3545;
            background: #f8d7da;
            border-radius: 10px;
            margin: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸŒŸ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ² ÙÙŠ ÙƒÙ„ ØµÙ ğŸŒŸ</h1>
            <p>Ù…Ø¯Ø±Ø³Ø© Ø§Ø¨Ù† Ø³ÙŠÙ†Ø§ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© - Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</p>
        </div>

        <!-- Navigation -->
        <div class="nav-container">
            <div id="classSelector">
                <!-- Will be populated by JavaScript -->
            </div>
            <div class="auto-play-controls">
                <button class="control-btn" id="autoPlayBtn" onclick="startAutoPlay()">â–¶ï¸ Ø¹Ø±Ø¶ ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
                <button class="control-btn stop hidden" id="stopBtn" onclick="stopAutoPlay()">â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù</button>
                <span style="color: #666;">Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ ÙƒÙ„: <strong id="intervalDisplay">10</strong> Ø«ÙˆØ§Ù†</span>
            </div>
        </div>

        <!-- Class Display -->
        <div class="class-display" id="classDisplay">
            <div class="loading">
                <div class="spinner"></div>
                <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† GitHub...</p>
            </div>
        </div>
    </div>

    <script>
        // ØªÙ†Ø¸ÙŠÙ… Ø§Ù„ØµÙÙˆÙ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
        const gradeGroups = {
            'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø«': ['Ø§Ù„Ø«Ø§Ù„Ø« 1', 'Ø§Ù„Ø«Ø§Ù„Ø« 2', 'Ø§Ù„Ø«Ø§Ù„Ø« 3', 'Ø§Ù„Ø«Ø§Ù„Ø« 4', 'Ø§Ù„Ø«Ø§Ù„Ø« 5'],
            'Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹': ['Ø§Ù„Ø±Ø§Ø¨Ø¹ 1', 'Ø§Ù„Ø±Ø§Ø¨Ø¹ 2', 'Ø§Ù„Ø±Ø§Ø¨Ø¹ 3', 'Ø§Ù„Ø±Ø§Ø¨Ø¹ 4', 'Ø§Ù„Ø±Ø§Ø¨Ø¹ 5'],
            'Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³': ['Ø§Ù„Ø®Ø§Ù…Ø³ 1', 'Ø§Ù„Ø®Ø§Ù…Ø³ 2', 'Ø§Ù„Ø®Ø§Ù…Ø³ 3', 'Ø§Ù„Ø®Ø§Ù…Ø³ 4'],
            'Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³': ['Ø§Ù„Ø³Ø§Ø¯Ø³ 1', 'Ø§Ù„Ø³Ø§Ø¯Ø³ 2', 'Ø§Ù„Ø³Ø§Ø¯Ø³ 3', 'Ø§Ù„Ø³Ø§Ø¯Ø³ 4']
        };

        const subjects = [
            { name: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', icon: 'ğŸ“–' },
            { name: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø¨Ø±ÙŠØ©', icon: 'ğŸ”¤' },
            { name: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©', icon: 'ğŸŒ' },
            { name: 'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª', icon: 'ğŸ”¢' }
        ];

        let autoPlayInterval = null;
        let currentClassIndex = 0;
        let allClasses = [];
        let studentsData = {};

        // Get all class names
        Object.values(gradeGroups).forEach(classes => {
            allClasses = allClasses.concat(classes);
        });

        // GitHub settings - get from URL parameter or use default
        const urlParams = new URLSearchParams(window.location.search);
        const githubRepo = urlParams.get('repo') || 'ibnsenaschhol/ayadtest';
        const githubBranch = urlParams.get('branch') || 'main';
        const githubFilePath = urlParams.get('file') || 'wel/motfokon/students-data.json';

        // Load data from GitHub
        async function loadFromGitHub() {
            try {
                const url = `https://api.github.com/repos/${githubRepo}/contents/${githubFilePath}?ref=${githubBranch}`;
                
                const response = await fetch(url, {
                    headers: {
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (!response.ok) {
                    throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }

                const data = await response.json();
                const content = atob(data.content);
                studentsData = JSON.parse(content);
                
                initClassSelector();
                displayClass(allClasses[0]);
            } catch (error) {
                console.error('Error loading from GitHub:', error);
                document.getElementById('classDisplay').innerHTML = `
                    <div class="error-message">
                        <h2>âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
                        <p>ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª GitHub ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p>
                        <p style="margin-top: 10px; font-size: 0.9em;">Repository: ${githubRepo}</p>
                    </div>
                `;
            }
        }

        // Initialize class selector buttons with grade grouping
        function initClassSelector() {
            const selector = document.getElementById('classSelector');
            selector.innerHTML = '';
            
            Object.keys(gradeGroups).forEach(gradeTitle => {
                const gradeDiv = document.createElement('div');
                gradeDiv.className = 'grade-group';
                
                const title = document.createElement('div');
                title.className = 'grade-title';
                title.textContent = gradeTitle;
                gradeDiv.appendChild(title);
                
                const buttonsDiv = document.createElement('div');
                buttonsDiv.className = 'class-selector';
                
                gradeGroups[gradeTitle].forEach(className => {
                    const btn = document.createElement('button');
                    btn.className = 'class-btn';
                    btn.textContent = className;
                    btn.onclick = () => displayClass(className);
                    buttonsDiv.appendChild(btn);
                });
                
                gradeDiv.appendChild(buttonsDiv);
                selector.appendChild(gradeDiv);
            });
        }

        // Display specific class
        function displayClass(className) {
            const display = document.getElementById('classDisplay');
            const student = studentsData[className];
            
            // Update active button
            document.querySelectorAll('.class-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === className) {
                    btn.classList.add('active');
                }
            });

            if (!student || !student.name) {
                display.innerHTML = `
                    <h2 class="class-title">${className}</h2>
                    <div class="no-data">
                        Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ² Ù„Ù‡Ø°Ø§ Ø§Ù„ØµÙ Ø¨Ø¹Ø¯
                    </div>
                `;
                return;
            }

            let subjectsHTML = '';
            subjects.forEach(subject => {
                subjectsHTML += `
                    <div class="subject-item">
                        <span class="subject-icon">${subject.icon}</span>
                        <span class="subject-name">${subject.name}</span>
                    </div>
                `;
            });

            display.innerHTML = `
                <h2 class="class-title">Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ² ÙÙŠ ${className}</h2>
                <div class="student-card">
                    <div class="student-photo">
                        ${student.photo ? `<img src="${student.photo}" alt="${student.name}">` : 'ğŸ‘¤'}
                    </div>
                    <div class="student-name">${student.name}</div>
                    <div class="star-badge">â­ Ù…ØªÙ…ÙŠØ² Ø§Ù„ØµÙ â­</div>
                    
                    <div class="average-section">
                        <div class="average-label">Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¹Ø§Ù… Ø¹Ù„Ù‰ 4 Ù…ÙˆØ§Ø¶ÙŠØ¹</div>
                        <div class="average-value">${student.average}%</div>
                        
                        <div class="subjects-list">
                            ${subjectsHTML}
                        </div>
                    </div>
                </div>
            `;
        }

        // Auto play functionality
        function startAutoPlay() {
            if (autoPlayInterval) return;
            
            document.getElementById('autoPlayBtn').classList.add('hidden');
            document.getElementById('stopBtn').classList.remove('hidden');
            
            currentClassIndex = 0;
            displayClass(allClasses[currentClassIndex]);
            
            autoPlayInterval = setInterval(() => {
                currentClassIndex = (currentClassIndex + 1) % allClasses.length;
                displayClass(allClasses[currentClassIndex]);
            }, 10000);
        }

        function stopAutoPlay() {
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
            }
            
            document.getElementById('autoPlayBtn').classList.remove('hidden');
            document.getElementById('stopBtn').classList.add('hidden');
        }

        // Initialize on page load
        window.onload = function() {
            loadFromGitHub();
        };
    </script>
</body>
</html>
