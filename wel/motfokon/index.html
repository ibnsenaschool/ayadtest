<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙÙˆÙ‚ÙŠÙ†</title>

<style>
/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* RESET */
*{margin:0;padding:0;box-sizing:border-box;font-family: 'Segoe UI', Tahoma}

/* Ø§Ù„Ø®Ù„ÙÙŠØ© */
body{
    background:linear-gradient(135deg,#667eea,#764ba2);
    padding:20px;
    min-height:100vh;
}

.container{
    max-width:1200px;
    margin:auto;
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
.header{
    background:white;
    padding:25px;
    border-radius:20px;
    text-align:center;
    margin-bottom:25px;
    box-shadow:0 10px 25px rgba(0,0,0,0.2);
}
.header h1{
    font-size:2em;color:#5b5de5;margin-bottom:10px;
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* Ø£Ø²Ø±Ø§Ø± */
.actions{
    display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:20px;
}
.btn{
    padding:10px 22px;border:none;border-radius:10px;font-weight:bold;font-size:1em;
    cursor:pointer;transition:0.3s;
}
.btn-primary{background:#28a745;color:#fff}
.btn-secondary{background:#667eea;color:#fff}
.btn-warning{background:#ffc107}
.btn-danger{background:#dc3545;color:#fff}
.btn:hover{transform:translateY(-3px)}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
.content{
    background:white;
    padding:25px;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.2);
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„ØµÙÙˆÙ */
.grade-header{
    background:#5b5de5;color:#fff;padding:12px 18px;border-radius:10px;
    margin-bottom:15px;font-size:1.3em;font-weight:bold;
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* Grid */
.classes-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
    gap:20px;
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* Ø¨Ø·Ø§Ù‚Ø© Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ */
.student-card{
    background:linear-gradient(135deg,#ffffff,#faf5ff);
    border:3px solid #d3c3ff;
    border-radius:20px;
    padding:20px;
    text-align:center;
    box-shadow:0 6px 30px rgba(0,0,0,0.15);
    transition:0.3s;
}
.student-card:hover{
    transform:scale(1.03);
    box-shadow:0 12px 40px rgba(0,0,0,0.25);
}

.student-photo{
    width:120px;height:120px;margin:auto;margin-bottom:15px;
    border-radius:50%;overflow:hidden;border:4px solid #a78bfa;
    background:#f3f0ff;
}
.student-photo img{width:100%;height:100%;object-fit:cover}

.student-name{
    font-size:1.4em;color:#5b21b6;font-weight:bold;margin-bottom:5px;
}

.student-average{
    font-size:1.2em;color:#4c1d95;margin-bottom:12px;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
.card-buttons{
    display:flex;justify-content:center;gap:10px;
}
.card-btn{
    padding:8px 15px;border:none;border-radius:8px;font-weight:bold;cursor:pointer;
}
.btn-edit{background:#6366f1;color:white}
.btn-delete{background:#ef4444;color:white}

/* Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ */
.add-student-btn{
    display:block;margin:15px auto;
    padding:12px 20px;background:#34d399;color:white;
    border:none;border-radius:10px;cursor:pointer;font-weight:bold;
}
.add-student-btn:hover{background:#059669;transform:translateY(-2px)}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
/* Ù†Ø§ÙØ°Ø© Ù‚Øµ Ø§Ù„ØµÙˆØ±Ø© */
.modal{
    display:none;position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.8);justify-content:center;align-items:center;
    z-index:2000;
}
.modal.show{display:flex}

.modal-content{
    background:white;padding:25px;border-radius:20px;width:90%;max-width:500px;
}
.crop-container{
    width:260px;height:260px;margin:auto;margin-bottom:15px;
    border-radius:50%;overflow:hidden;position:relative;border:3px solid #764ba2;
}
.crop-image{
    position:absolute;top:50%;left:50%;
    transform:translate(-50%,-50%);cursor:move;user-select:none;
}

</style>
</head>

<body>

<div class="container">

<!-- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Header â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” -->
<div class="header">
    <h1>âš™ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙÙˆÙ‚ÙŠÙ†</h1>
    <p>Ø¥Ø¶Ø§ÙØ© â€” ØªØ¹Ø¯ÙŠÙ„ â€” Ø­Ø°Ù â€” ØªØ®Ø²ÙŠÙ† GitHub</p>
    <div id="githubStatus" style="margin-top:10px;font-weight:bold;color:#fff;background:#333;border-radius:10px;padding:8px">
        ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ù€ GitHub
    </div>

    <div class="actions">
        <button class="btn btn-warning" onclick="openSettings()">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª GitHub</button>
        <button class="btn btn-primary" id="saveBtn" onclick="saveToGitHub()" disabled>ğŸ’¾ Ø­ÙØ¸</button>
        <button class="btn btn-secondary" id="loadBtn" onclick="loadFromGitHub()" disabled>ğŸ“¥ ØªØ­Ù…ÙŠÙ„</button>
    </div>
</div>

<!-- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Main Content â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” -->
<div class="content" id="formsContainer">
    <p style="text-align:center;font-size:1.3em;color:#555">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„â€¦</p>
</div>

<!-- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Crop Modal â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” -->
<div id="cropperModal" class="modal">
    <div class="modal-content">
        <h3 style="text-align:center;color:#764ba2;margin-bottom:10px">âœ‚ï¸ Ù‚Øµ Ø§Ù„ØµÙˆØ±Ø©</h3>

        <div class="crop-container">
            <img id="cropImage" class="crop-image">
        </div>

        <input type="range" id="zoomSlider" min="50" max="200" value="100" style="width:100%;margin-bottom:15px">

        <div style="display:flex;gap:10px">
            <button class="btn btn-primary" style="flex:1" onclick="applyCrop()">ØªØ·Ø¨ÙŠÙ‚</button>
            <button class="btn btn-danger" style="flex:1" onclick="closeCropper()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>
</div>

</div>

<!-- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” SCRIPTS â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” -->
<script>

/* Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„ØµÙÙˆÙ */
const gradeGroups = {
    "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø«":["Ø§Ù„Ø«Ø§Ù„Ø« 1","Ø§Ù„Ø«Ø§Ù„Ø« 2","Ø§Ù„Ø«Ø§Ù„Ø« 3","Ø§Ù„Ø«Ø§Ù„Ø« 4","Ø§Ù„Ø«Ø§Ù„Ø« 5"],
    "Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹":["Ø§Ù„Ø±Ø§Ø¨Ø¹ 1","Ø§Ù„Ø±Ø§Ø¨Ø¹ 2","Ø§Ù„Ø±Ø§Ø¨Ø¹ 3","Ø§Ù„Ø±Ø§Ø¨Ø¹ 4","Ø§Ù„Ø±Ø§Ø¨Ø¹ 5"],
    "Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³":["Ø§Ù„Ø®Ø§Ù…Ø³ 1","Ø§Ù„Ø®Ø§Ù…Ø³ 2","Ø§Ù„Ø®Ø§Ù…Ø³ 3","Ø§Ù„Ø®Ø§Ù…Ø³ 4"],
    "Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³":["Ø§Ù„Ø³Ø§Ø¯Ø³ 1","Ø§Ù„Ø³Ø§Ø¯Ø³ 2","Ø§Ù„Ø³Ø§Ø¯Ø³ 3","Ø§Ù„Ø³Ø§Ø¯Ø³ 4"]
};

let currentData = {};
let currentCropClass = null;
let currentCropIndex = null;
let currentImageData = null;

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” GitHub Settings â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
let githubSettings = {
    token:"",
    repo:"",
    branch:"main",
    filePath:"students-data.json"
};

function openSettings(){
    const t = prompt("GitHub Token:", githubSettings.token);
    const r = prompt("Repository: (Ù…Ø«Ø§Ù„ username/repo)", githubSettings.repo);
    if(!t || !r) return;

    githubSettings.token = t;
    githubSettings.repo  = r;

    document.getElementById("saveBtn").disabled = false;
    document.getElementById("loadBtn").disabled = false;

    document.getElementById("githubStatus").innerHTML = "ğŸŸ¢ Ù…ØªØµÙ„ Ø¨Ù€ GitHub";
}

async function loadFromGitHub(){
    try{
        const url = `https://api.github.com/repos/${githubSettings.repo}/contents/${githubSettings.filePath}?ref=${githubSettings.branch}`;
        const res = await fetch(url,{
            headers:{
                "Authorization":"token "+githubSettings.token
            }
        });

        if(!res.ok){ initForms(); return; }

        const data = await res.json();
        const content = atob(data.content);
        currentData = JSON.parse(content);

        initForms();
    }catch{
        initForms();
    }
}

async function saveToGitHub(){
    collectFormData();

    const content = btoa(unescape(encodeURIComponent(JSON.stringify(currentData,null,2))));

    const url = `https://api.github.com/repos/${githubSettings.repo}/contents/${githubSettings.filePath}`;

    await fetch(url,{
        method:"PUT",
        headers:{
            "Authorization":"token "+githubSettings.token,
            "Content-Type":"application/json"
        },
        body:JSON.stringify({
            message:"update",
            content:content,
            branch:githubSettings.branch
        })
    });

    alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ”ï¸");
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø¨Ù†Ø§Ø¡ Ø§Ù„ØµÙØ­Ø© â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */

function initForms(){
    const container = document.getElementById("formsContainer");
    container.innerHTML = "";

    for(const gradeTitle in gradeGroups){
        const section = document.createElement("div");
        section.innerHTML = `<div class="grade-header">${gradeTitle}</div>`;

        const addBtn = document.createElement("button");
        addBtn.className = "add-student-btn";
        addBtn.textContent = "â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯";
        addBtn.onclick = ()=> addStudentToClass(gradeTitle);
        section.appendChild(addBtn);

        const grid = document.createElement("div");
        grid.className = "classes-grid";

        gradeGroups[gradeTitle].forEach(className=>{
            const students = currentData[className] || [];

            students.forEach((student,index)=>{
                const card = document.createElement("div");
                card.className = "student-card";

                card.innerHTML = `
                    <div class="student-photo">
                        ${student.photo ? `<img src="${student.photo}">` : ""}
                    </div>
                    <div class="student-name">${student.name}</div>
                    <div class="student-average">Ø§Ù„Ù…Ø¹Ø¯Ù„: ${student.average}%</div>

                    <div class="card-buttons">
                        <button class="card-btn btn-edit" onclick="editStudentPhoto('${className}',${index})">âœï¸ ØµÙˆØ±Ø©</button>
                        <button class="card-btn btn-delete" onclick="deleteStudent('${className}',${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                `;

                grid.appendChild(card);
            });
        });

        section.appendChild(grid);
        container.appendChild(section);
    }
}




/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */

function addStudentToClass(className){
    const name = prompt("Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:");
    if(!name) return;

    const avg = prompt("Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ø§Ù„Ø¨:");
    if(!avg) return;

    if(!currentData[className]) currentData[className] = [];

    currentData[className].push({
        name:name,
        average:avg,
        photo:""
    });

    initForms();
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø­Ø°Ù Ø·Ø§Ù„Ø¨ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */

function deleteStudent(className,index){
    if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ØŸ")){
        currentData[className].splice(index,1);
        initForms();
    }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ØªØ¹Ø¯ÙŠÙ„ ØµÙˆØ±Ø© â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */

function editStudentPhoto(className,index){
    currentCropClass = className;
    currentCropIndex = index;

    const input = document.createElement("input");
    input.type = "file";
    input.accept = "image/*";

    input.onchange = function(){
        const file = input.files[0];
        const reader = new FileReader();

        reader.onload = e=>{
            currentImageData = e.target.result;
            openCropper(e.target.result);
        };

        reader.readAsDataURL(file);
    };

    input.click();
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø§Ù„Ù‚Øµ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */

function openCropper(photo){
    document.getElementById("cropImage").src = photo;
    document.getElementById("zoomSlider").value = 100;
    document.getElementById("cropperModal").classList.add("show");
}

function closeCropper(){
    document.getElementById("cropperModal").classList.remove("show");
}

function applyCrop(){
    const img = document.getElementById("cropImage");
    const canvas = document.createElement("canvas");
    canvas.width = 300;canvas.height = 300;

    const ctx = canvas.getContext("2d");

    ctx.beginPath();
    ctx.arc(150,150,150,0,Math.PI*2);
    ctx.closePath();
    ctx.clip();

    ctx.drawImage(img,0,0,300,300);

    const cropped = canvas.toDataURL("image/png");

    currentData[currentCropClass][currentCropIndex].photo = cropped;

    closeCropper();
    initForms();
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function collectFormData(){
    // Ù„Ø§ Ø­Ø§Ø¬Ø© â€” Ù„Ø£Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙØ­Ø¯Ù‘Ø« Ù…Ø¨Ø§Ø´Ø±Ø©
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
window.onload = function(){
    initForms();
};

</script>

</body>
</html>
